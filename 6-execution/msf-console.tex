% BK: Dieser Abschnitt ausgelagert, weil er nicht recht zum C&C-Server passt
% und noch nicht feststeht wo, und ob wir ihn überhaupt irgendwo unterbringen.
%
\subsection{Msf-Console}

\TODO{\HM: im Normalfall, ist komisch: }
Metasploit wird im Normalfall über die Konsole(\textit{msfconsole})
bedient.  Dies sollte auch im C\&C-Server möglich sein. Weil diese
Möglichkeit der Interaktion mit Metasploit schlecht dokumentiert ist
soll an dieser Stelle kurz gezeigt werden, wie man sowohl mit
Metasploit, als auch mit Meterpreter-Sessions interagieren
kann.\TODO{\DE warum???? meiner meinung nach hat die msf console
  relativ wenig mit dem C\&C server zu tun. warum wird das hier
  ueberhaupt angesprochen. und wenn hier die msf consolte besprochen
  wird, warum machen wir dann die doku, die 1. wenn ueberhaupt an
  einer andere stelle gehoehren wuerde und 2. weder erschoepfend noch
  zielfuehren ist. wenn dann sollten wir hier einen ueberblick
  darueber geben, was man mit der konsole machen kann. }

\begin{lstlisting}
  # init console with metasploit framwork @console =
  Msf::Ui::Web::WebConsole.new(@framework,1)

  # used to exec a command like it would be typed into msfconsole def
  cmd_send_to_terminal cmd @console.execute(cmd) return
  @console.read+@console.prompt end

  # used to interact with an open meterpreter session def
  cmd_send_to_msfsession cmd, session_uuid input =
  Rex::Ui::Text::Input::Readline.new output =
  Rex::Ui::Text::Output::Buffer.new

    session = get_session_by_uuid @framework.sessions, session_uuid
    session.init_ui(input,output) session.run_cmd(cmd) return
    session.console.output.dump_buffer end
\end{lstlisting}
